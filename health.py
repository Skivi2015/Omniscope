\nfrom __future__ import annotations\nimport time\n\nclass CircuitBreaker:\n    """Simple circuit breaker."""\n\n    def __init__(self, window: int = 5, cool: float = 5.0) -> None:\n        self.window = window\n        self.cool = cool\n        self.fail = 0\n        self.open = False\n        self.opened_at = 0.0\n\n    def record(self, success: bool) -> None:\n        if self.open and (time.time() - self.opened_at) > self.cool:\n            self.open = False\n            self.fail = 0\n        if success:\n            self.fail = 0\n            return\n        self.fail += 1\n        if self.fail >= self.window:\n            self.open = True\n            self.opened_at = time.time()\n
