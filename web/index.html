<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>OmniScope Bots</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="bg-slate-950 text-slate-100 min-h-screen">
    <main class="max-w-5xl mx-auto p-6 space-y-6">
      <h1 class="text-3xl font-bold">OmniScope Bots</h1>
      <p class="text-slate-400">Modular agent framework with hot-reloadable skills and adaptive tool selection.</p>
      
      <!-- Bot Selection -->
      <div class="grid md:grid-cols-3 gap-6">
        <div class="p-5 rounded-2xl bg-slate-900">
          <h3 class="font-semibold">Seomi</h3>
          <p class="text-slate-400 text-sm">SEO content helper</p>
          <button onclick="selectBot('seomi')" class="mt-3 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm">Select</button>
        </div>
        <div class="p-5 rounded-2xl bg-slate-900">
          <h3 class="font-semibold">Soshie</h3>
          <p class="text-slate-400 text-sm">Social media helper</p>
          <button onclick="selectBot('soshie')" class="mt-3 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm">Select</button>
        </div>
        <div class="p-5 rounded-2xl bg-slate-900">
          <h3 class="font-semibold">Scouty</h3>
          <p class="text-slate-400 text-sm">Ops helper</p>
          <button onclick="selectBot('scouty')" class="mt-3 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm">Select</button>
        </div>
        <div class="p-5 rounded-2xl bg-slate-900">
          <h3 class="font-semibold">Cookie</h3>
          <p class="text-slate-400 text-sm">Real-time trading agent</p>
          <button onclick="selectBot('Cookie')" class="mt-3 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 text-sm">Select</button>
        </div>
        <div class="p-5 rounded-2xl bg-slate-900">
          <h3 class="font-semibold">Rusty</h3>
          <p class="text-slate-400 text-sm">Social media automation</p>
          <button onclick="selectBot('Rusty')" class="mt-3 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 text-sm">Select</button>
        </div>
        <div class="p-5 rounded-2xl bg-slate-900">
          <h3 class="font-semibold">Browny</h3>
          <p class="text-slate-400 text-sm">Playful analyst</p>
          <button onclick="selectBot('Browny')" class="mt-3 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 text-sm">Select</button>
        </div>
      </div>

      <!-- Task Input -->
      <div class="space-y-4">
        <div>
          <label class="block text-sm font-medium mb-2">Selected Bot:</label>
          <input id="bot" type="text" value="seomi" 
            class="w-full px-4 py-2 bg-slate-800 border border-slate-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
        </div>
        
        <div>
          <label class="block text-sm font-medium mb-2">Task:</label>
          <textarea id="task" rows="3"
            class="w-full px-4 py-2 bg-slate-800 border border-slate-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
            placeholder="Enter a task for the bot to execute...">python result = 2 + 2</textarea>
        </div>

        <div class="flex gap-3">
          <button onclick="solve()" 
            class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium">
            Execute Task
          </button>
          <button onclick="clearResult()" 
            class="px-6 py-2 bg-slate-700 text-white rounded-lg hover:bg-slate-600 font-medium">
            Clear
          </button>
        </div>
      </div>

      <!-- Example Tasks -->
      <div class="space-y-3">
        <h3 class="text-lg font-semibold">Example Tasks:</h3>
        <div class="grid md:grid-cols-2 gap-3">
          <button onclick="setTask('python result = 2 + 2')" 
            class="text-left p-3 bg-slate-800 rounded-lg hover:bg-slate-700 text-sm">
            <strong>Math:</strong> python result = 2 + 2
          </button>
          <button onclick="setTask('fetch https://httpbin.org/json')" 
            class="text-left p-3 bg-slate-800 rounded-lg hover:bg-slate-700 text-sm">
            <strong>HTTP:</strong> fetch https://httpbin.org/json
          </button>
          <button onclick="setTask('json {\"name\": \"test\", \"value\": 42}')" 
            class="text-left p-3 bg-slate-800 rounded-lg hover:bg-slate-700 text-sm">
            <strong>JSON:</strong> json {"name": "test", "value": 42}
          </button>
          <button onclick="setTask('python import json; result = json.dumps({\"status\": \"ok\"}); json')" 
            class="text-left p-3 bg-slate-800 rounded-lg hover:bg-slate-700 text-sm">
            <strong>Chain:</strong> python â†’ json transformation
          </button>
        </div>
      </div>

      <!-- Results -->
      <div class="space-y-3">
        <h3 class="text-lg font-semibold">Results:</h3>
        <div id="loading" class="hidden">
          <div class="flex items-center space-x-2">
            <div class="animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"></div>
            <span class="text-slate-400">Executing task...</span>
          </div>
        </div>
        <pre id="result" class="bg-slate-900 p-4 rounded-lg text-sm overflow-auto max-h-96 border border-slate-700"></pre>
      </div>
    </main>

    <script>
      const botInput = document.getElementById('bot');
      const taskInput = document.getElementById('task');
      const resultDiv = document.getElementById('result');
      const loadingDiv = document.getElementById('loading');

      function selectBot(botName) {
        botInput.value = botName;
      }

      function setTask(task) {
        taskInput.value = task;
      }

      function clearResult() {
        resultDiv.textContent = '';
      }

      async function solve() {
        const bot = botInput.value.trim();
        const task = taskInput.value.trim();
        
        if (!bot || !task) {
          alert('Please enter both bot name and task');
          return;
        }

        loadingDiv.classList.remove('hidden');
        resultDiv.textContent = '';

        try {
          const response = await fetch('/api/solve', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({ bot, task })
          });

          const data = await response.json();
          
          if (response.ok) {
            resultDiv.textContent = JSON.stringify(data, null, 2);
          } else {
            resultDiv.textContent = `Error: ${data.error || 'Unknown error'}`;
          }
        } catch (error) {
          resultDiv.textContent = `Network Error: ${error.message}`;
        } finally {
          loadingDiv.classList.add('hidden');
        }
      }

      // Add enter key support for the task input
      taskInput.addEventListener('keydown', function(e) {
        if (e.key === 'Enter' && e.ctrlKey) {
          solve();
        }
      });
    </script>
  </body>
</html>
