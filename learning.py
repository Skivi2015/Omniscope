\nfrom __future__ import annotations\nimport math\nfrom typing import Dict\n\nclass UCB1:\n    """Per-arm UCB1 bandit."""\n\n    def __init__(self) -> None:\n        self.counts: Dict[str, int] = {}\n        self.rewards: Dict[str, float] = {}\n        self.total: int = 0\n\n    def choose(self, arm: str) -> float:\n        self.total += 1\n        self.counts.setdefault(arm, 0)\n        self.rewards.setdefault(arm, 0.0)\n        c = self.counts[arm]\n        if c == 0:\n            self.counts[arm] = 1\n            return float("inf")\n        bonus = math.sqrt(2.0 * math.log(self.total) / c)\n        return self.rewards[arm] / c + bonus\n\n    def update(self, arm: str, success: bool) -> None:\n        self.counts[arm] = self.counts.get(arm, 0) + 1\n        self.rewards[arm] = self.rewards.get(arm, 0.0) + (1.0 if success else 0.0)\n
